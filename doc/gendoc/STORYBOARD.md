# åˆ†é•œç”Ÿæˆå·¥å…·ä½¿ç”¨è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

`storyboard` å·¥å…·æ˜¯æ­¥éª¤ä¸‰çš„å®ç°ï¼Œç”¨äºæ ¹æ®æ­¥éª¤ä¸€ç”Ÿæˆçš„å‰§æœ¬JSONæ–‡ä»¶ï¼Œä¸ºæ¯ä¸ªåœºæ™¯ç”ŸæˆåŒ¹é…çš„åŠ¨æ¼«é£æ ¼å›¾ç‰‡ã€‚

## æ ¸å¿ƒç‰¹æ€§

âœ… **åŠ¨æ¼«é£æ ¼**: æ‰€æœ‰å›¾ç‰‡ä½¿ç”¨anime visual novelé£æ ¼  
âœ… **çº¯åœºæ™¯å›¾ç‰‡**: ä¸“æ³¨äºåœºæ™¯å’Œè§’è‰²çš„è§†è§‰è¡¨ç°ï¼Œæ— æ–‡å­—å¯¹è¯  
âœ… **è§’è‰²ä¸€è‡´æ€§**: ä½¿ç”¨æ­¥éª¤äºŒç”Ÿæˆçš„"é»„é‡‘æè¿°"ç¡®ä¿è§’è‰²è§†è§‰ä¸€è‡´  
âœ… **æ‰¹é‡ç”Ÿæˆ**: è‡ªåŠ¨ä¸ºæ‰€æœ‰åœºæ™¯ç”Ÿæˆå›¾ç‰‡  
âœ… **é«˜è´¨é‡è¾“å‡º**: æ¸…æ™°çš„åœºæ™¯æ„å›¾ï¼Œæ— æ–‡å­—å¹²æ‰°  

## ç¼–è¯‘

```bash
go build -o storyboard ./cmd/storyboard
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ç”¨æ³•

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•°
./storyboard -input script.json

# æŒ‡å®šè¾“å‡ºç›®å½•
./storyboard -input script.json -output my-storyboard
```

### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|------|------|--------|------|
| `-input` | è¾“å…¥JSONæ–‡ä»¶(æ­¥éª¤ä¸€ç”Ÿæˆ) | å¿…å¡« | `script.json` |
| `-output` | è¾“å‡ºå›¾ç‰‡ç›®å½• | `storyboard` | `output` |
| `-size` | å›¾ç‰‡å°ºå¯¸ | `1536x1024` | `1024x1024` |
| `-layout` | åˆ†é•œå¸ƒå±€ | `auto` | `single`, `2-panel`, `3-panel`, `4-panel` |

### æ”¯æŒçš„å›¾ç‰‡å°ºå¯¸

æ ¹æ®[ä¸ƒç‰›äº‘APIæ–‡æ¡£](https://developer.qiniu.com/aitokenapi/13166/text-to-image-api):

**æ­£æ–¹å½¢**:
- `1024x1024`

**æ¨ªå‘** (æ¨èç”¨äºåŠ¨æ¼«åœºæ™¯):
- `1536x1024` (é»˜è®¤)
- `1792x1024`
- `1344x768`
- `1248x832`
- `1184x864`
- `1152x896`
- `1536x672`

**çºµå‘**:
- `1024x1536`
- `1024x1792`
- `768x1344`
- `832x1248`
- `864x1184`
- `896x1152`

### åˆ†é•œå¸ƒå±€æ¨¡å¼

| æ¨¡å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `auto` | è‡ªåŠ¨é€‰æ‹©(æ¨è) | æ ¹æ®å¯¹è¯æ•°é‡æ™ºèƒ½å†³å®š |
| `single` | å•æ ¼åœºæ™¯ | ç¯å¢ƒæå†™ã€åŠ¨ä½œåœºé¢ |
| `2-panel` | åŒæ ¼æ¼«ç”» | ç®€å•å¯¹è¯ |
| `3-panel` | ä¸‰æ ¼æ¼«ç”» | å¤šäººå¯¹è¯ |
| `4-panel` | å››æ ¼æ¼«ç”» | å¤æ‚å¯¹è¯åœºæ™¯ |

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºç¡€ä½¿ç”¨

```bash
# å…ˆç”Ÿæˆå‰§æœ¬
./novel2comicli -input story.txt -output story.json

# ç”Ÿæˆåˆ†é•œ
./storyboard -input story.json
```

ç”Ÿæˆçš„å›¾ç‰‡å°†ä¿å­˜åœ¨ `storyboard/` ç›®å½•:
```
storyboard/
â”œâ”€â”€ scene_001.png
â”œâ”€â”€ scene_002.png
â”œâ”€â”€ scene_003.png
...
```

### ç¤ºä¾‹2: è‡ªå®šä¹‰å‚æ•°

```bash
# ä½¿ç”¨æ­£æ–¹å½¢å°ºå¯¸ï¼Œå¼ºåˆ¶å•æ ¼å¸ƒå±€
./storyboard -input story.json -output images -size 1024x1024 -layout single
```

### ç¤ºä¾‹3: å®Œæ•´æµç¨‹

```bash
# æ­¥éª¤1: ç”Ÿæˆå‰§æœ¬å’Œè§’è‰²
./novel2comicli -input the-wandering-earth.txt -output earth.json

# æ­¥éª¤2: ç”Ÿæˆåˆ†é•œå›¾ç‰‡
./storyboard -input earth.json -output earth-storyboard -size 1536x1024

# æŸ¥çœ‹ç»“æœ
ls -lh earth-storyboard/
```

## æç¤ºè¯æ„å»ºé€»è¾‘

ç¨‹åºä¼šè‡ªåŠ¨æ„å»ºé«˜è´¨é‡çš„å›¾åƒç”Ÿæˆæç¤ºè¯ï¼ŒåŒ…å«:

1. **åŸºç¡€é£æ ¼**: `Anime visual novel style, detailed anime art, cinematic composition`
2. **åœºæ™¯ç±»å‹**: `single full scene illustration, NO text, NO dialogue bubbles`
3. **åœºæ™¯åœ°ç‚¹**: æ¥è‡ª`location`å­—æ®µ
4. **æ—¶é—´è®¾å®š**: æ¥è‡ª`time_of_day`å­—æ®µï¼ˆå¦‚æœ‰ï¼‰
5. **è§’è‰²æè¿°**: æ³¨å…¥"é»„é‡‘æè¿°"ç¡®ä¿ä¸€è‡´æ€§
6. **åŠ¨ä½œæè¿°**: æ¥è‡ª`action_description`å­—æ®µï¼ˆæ ¸å¿ƒå†…å®¹ï¼‰
7. **è§†è§‰ç»†èŠ‚**: æ¥è‡ª`visual_description`å­—æ®µ
8. **æƒ…æ„Ÿæ°›å›´**: æ¥è‡ª`emotional_tone`å­—æ®µ
9. **é•œå¤´è§’åº¦**: æ¥è‡ª`camera_shot`å­—æ®µ
10. **èƒŒæ™¯å…ƒç´ **: æ¥è‡ª`background_elements`æ•°ç»„
11. **è´¨é‡å¼ºåŒ–**: `High quality anime art, professional illustration, clean visual storytelling`

### å…³äºå›¾ç‰‡å†…å®¹

**ä¸ºä»€ä¹ˆä¸åŒ…å«æ–‡å­—å¯¹è¯ï¼Ÿ**

ç”±äºå›¾åƒç”Ÿæˆæ¨¡å‹åœ¨æ–‡å­—æ¸²æŸ“æ–¹é¢å­˜åœ¨æŠ€æœ¯é™åˆ¶ï¼ˆä¸­æ–‡ã€è‹±æ–‡éƒ½å®¹æ˜“å‡ºç°é”™è¯¯æˆ–ä¹±ç ï¼‰ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†**çº¯è§†è§‰åœºæ™¯**çš„æ–¹æ¡ˆï¼š

âœ… **ä¼˜ç‚¹**ï¼š
- å›¾ç‰‡è´¨é‡æ›´é«˜ï¼Œæ— æ–‡å­—é”™è¯¯
- ä¸“æ³¨äºè§†è§‰è¡¨ç°å’Œåœºæ™¯ç¾æ„Ÿ
- è§’è‰²è¡¨æƒ…å’ŒåŠ¨ä½œæ›´çªå‡º
- é…åˆæ­¥éª¤å››çš„è¯­éŸ³æ•ˆæœæ›´ä½³

ğŸ’¡ **å¯¹è¯å¤„ç†**ï¼š
- å¯¹è¯å†…å®¹ç”±æ­¥éª¤å››ï¼ˆéŸ³é¢‘åˆæˆï¼‰ç”Ÿæˆè¯­éŸ³æ–‡ä»¶
- å¯ä»¥åœ¨åæœŸæ·»åŠ å­—å¹•æˆ–æ–‡å­—å›¾å±‚
- çº¯è§†è§‰+è¯­éŸ³çš„æ–¹å¼æ›´æ¥è¿‘åŠ¨ç”»æ•ˆæœ

### æç¤ºè¯ç¤ºä¾‹ï¼ˆè‹±æ–‡ç‰ˆï¼‰

```
Anime visual novel style, manga artwork, detailed anime art, cinematic composition, 
with English text in dialogue bubbles and subtitles, 
manga panel layout with 2 panels showing dialogue exchange, 
Location: æ‹œå…‹åŠªå°”èˆªå¤©åŸºåœ°å‘å°„æ¶æ—. 
Characters: 50å²å·¦å³çš„è‹è”ç”·æ€§ï¼Œæˆ´ç€åšé‡çš„çœ¼é•œï¼Œç©¿ç€ç°è‰²å·¥ç¨‹å¸ˆåˆ¶æœ..., 
and å¤–æ˜Ÿäººä¼ªè£…æˆäººç±»ï¼Œ30å²å·¦å³çš„æ¨¡ç³Šæ€§åˆ«äººå½¢ï¼Œç©¿ç€ç®€æ´çš„é»‘è‰²è¥¿è£….... 
Action: ç§‘ç½—å»–å¤«çœ‹ç€åˆšåˆšå‡ç©ºçš„ç«ç®­ç•™ä¸‹çš„å°¾è¿¹ï¼Œèº«æ—ä¸€ä¸ªç¥ç§˜çš„é™Œç”Ÿäººå‘ä»–èµ°æ¥. 
Scene dialogue: G says: "æ€»è®¾è®¡å¸ˆåŒå¿—ï¼Œè¯·æ¥å—ä¸€ä¸ªæ™®é€šäººçš„ç¥è´ºï¼", 
then è°¢å°”ç›–Â·ç§‘ç½—å»–å¤« says: "è°¢è°¢ï¼Œä½ çš„ç¬‘è¯ï¼Ÿ". 
Show these dialogues in speech bubbles with clear English text. 
High quality anime art, professional manga illustration, detailed backgrounds, 
expressive characters, dramatic lighting. 
All dialogue bubbles must show clear, readable English text. 
Use standard English language for all text elements.
```

**è¯´æ˜**: è™½ç„¶å¯¹è¯å†…å®¹æ˜¯ä¸­æ–‡ï¼Œä½†æç¤ºè¯æ˜ç¡®è¦æ±‚æ¨¡å‹åœ¨å›¾ç‰‡ä¸­ä½¿ç”¨è‹±æ–‡æ–‡å­—ã€‚æ¨¡å‹ä¼šç†è§£å¯¹è¯å«ä¹‰å¹¶ç”Ÿæˆç›¸åº”çš„è‹±æ–‡æ–‡å­—æ˜¾ç¤ºã€‚

## æ€§èƒ½å’Œæˆæœ¬

- **ç”Ÿæˆæ—¶é—´**: çº¦10-15ç§’/å¼ å›¾ç‰‡
- **Tokenæ¶ˆè€—**: çº¦5000 tokens/å¼ å›¾ç‰‡
- **å›¾ç‰‡å¤§å°**: çº¦1-2MB/å¼ (PNGæ ¼å¼)

### æ‰¹é‡ç”Ÿæˆä¼°ç®—

| åœºæ™¯æ•° | é¢„è®¡æ—¶é—´ | Tokenæ¶ˆè€— |
|--------|----------|-----------|
| 5ä¸ª | 1åˆ†é’Ÿ | 25K tokens |
| 10ä¸ª | 2åˆ†é’Ÿ | 50K tokens |
| 20ä¸ª | 4åˆ†é’Ÿ | 100K tokens |

## æŠ€æœ¯ç»†èŠ‚

### APIä½¿ç”¨

- **æ¨¡å‹**: `gemini-2.5-flash-image` (Nano Banana)
- **æ¥å…¥ç‚¹**: `https://openai.qiniu.com/v1`
- **æ¥å£**: `/v1/images/generations`
- **æ ¼å¼**: Base64ç¼–ç çš„PNGå›¾ç‰‡

### è§’è‰²ä¸€è‡´æ€§å®ç°

ç¨‹åºé€šè¿‡ä»¥ä¸‹æ–¹å¼ç¡®ä¿è§’è‰²è§†è§‰ä¸€è‡´æ€§:

1. è¯»å–æ­¥éª¤äºŒç”Ÿæˆçš„`characters`å­—å…¸
2. ä¸ºåœºæ™¯ä¸­çš„æ¯ä¸ªè§’è‰²æ³¨å…¥å®Œæ•´çš„"é»„é‡‘æè¿°"
3. æ¯æ¬¡å›¾åƒç”Ÿæˆéƒ½é‡å¤è¿™ä¸ªæè¿°
4. é¿å…ä¾èµ–æ¨¡å‹"è®°å¿†"è§’è‰²

## å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆå›¾ç‰‡ä¸­çš„æ–‡å­—æ˜¯è‹±æ–‡è€Œä¸æ˜¯ä¸­æ–‡ï¼Ÿ**  
A: å›¾åƒç”Ÿæˆæ¨¡å‹åœ¨ç”Ÿæˆå‡†ç¡®çš„ä¸­æ–‡æ–‡å­—æ–¹é¢æœ‰æŠ€æœ¯é™åˆ¶ï¼Œå®¹æ˜“å‡ºç°å­—ç¬¦é”™è¯¯ã€å˜å½¢æˆ–ä¹±ç ã€‚ä½¿ç”¨è‹±æ–‡å¯ä»¥ç¡®ä¿æ–‡å­—æ¸…æ™°å¯è¯»ã€‚è¿™æ˜¯å½“å‰AIå›¾åƒç”ŸæˆæŠ€æœ¯çš„é™åˆ¶ã€‚

**Q: èƒ½å¦ç”Ÿæˆä¸­æ–‡æ–‡å­—çš„å›¾ç‰‡ï¼Ÿ**  
A: ç›®å‰Gemini 2.5 Flash Imageæ¨¡å‹å¯¹ä¸­æ–‡æ”¯æŒæœ‰é™ã€‚å¦‚æœéœ€è¦ä¸­æ–‡ï¼Œå»ºè®®åœ¨åæœŸä½¿ç”¨å›¾ç‰‡ç¼–è¾‘å·¥å…·æ‰‹åŠ¨æ·»åŠ ä¸­æ–‡å­—å¹•ï¼Œæˆ–ç­‰å¾…æ”¯æŒä¸­æ–‡çš„å›¾åƒç”Ÿæˆæ¨¡å‹ã€‚

**Q: å›¾ç‰‡ä¸æ˜¯åŠ¨æ¼«é£æ ¼æ€ä¹ˆåŠ?**  
A: æç¤ºè¯å·²å¼ºåˆ¶ä½¿ç”¨`Anime visual novel style`å’Œ`manga artwork`ï¼Œåº”è¯¥èƒ½ç¡®ä¿é£æ ¼ã€‚å¦‚æœä»æœ‰é—®é¢˜ï¼Œå¯èƒ½éœ€è¦åœ¨`action_description`ä¸­ä¹Ÿå¼ºè°ƒ"åŠ¨æ¼«é£æ ¼"ã€‚

**Q: è§’è‰²å¤–è§‚ä¸ä¸€è‡´æ€ä¹ˆåŠ?**  
A: æ£€æŸ¥æ­¥éª¤ä¸€ç”Ÿæˆçš„JSONä¸­`characters`å­—æ®µçš„æè¿°æ˜¯å¦è¶³å¤Ÿè¯¦ç»†ã€‚å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘JSONæ–‡ä»¶å¢å¼ºè§’è‰²æè¿°ã€‚

**Q: ç”Ÿæˆå¤±è´¥æ€ä¹ˆåŠ?**  
A: ç¨‹åºä¼šè·³è¿‡å¤±è´¥çš„åœºæ™¯ç»§ç»­å¤„ç†å…¶ä»–åœºæ™¯ã€‚æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIé…é¢ã€‚

**Q: èƒ½å¦ç”Ÿæˆæ›´å¤§çš„å›¾ç‰‡?**  
A: å—APIé™åˆ¶ï¼Œç›®å‰æœ€å¤§æ”¯æŒ`1792x1024`ã€‚

**Q: å¦‚ä½•åŠ å¿«ç”Ÿæˆé€Ÿåº¦?**  
A: å¯ä»¥å¹¶è¡Œè¿è¡Œå¤šä¸ªå®ä¾‹å¤„ç†ä¸åŒçš„åœºæ™¯(éœ€è¦æ‰‹åŠ¨æ‹†åˆ†JSONæ–‡ä»¶)ã€‚

**Q: å›¾ç‰‡è´¨é‡ä¸æ»¡æ„æ€ä¹ˆåŠ?**  
A: å¯ä»¥:
1. ä¼˜åŒ–æ­¥éª¤ä¸€ä¸­çš„`action_description`ä½¿å…¶æ›´å…·ç”»é¢æ„Ÿ
2. å¢å¼ºæ­¥éª¤äºŒä¸­çš„è§’è‰²è§†è§‰æè¿°
3. æ‰‹åŠ¨ç¼–è¾‘JSONåé‡æ–°ç”Ÿæˆ
4. åæœŸä½¿ç”¨Photoshopç­‰å·¥å…·ç¼–è¾‘

## è¾“å‡ºæ ¼å¼

ç”Ÿæˆçš„å›¾ç‰‡æŒ‰åœºæ™¯IDå‘½å:

```
storyboard/
â”œâ”€â”€ scene_001.png  # åœºæ™¯1
â”œâ”€â”€ scene_002.png  # åœºæ™¯2
â”œâ”€â”€ scene_003.png  # åœºæ™¯3
...
```

å›¾ç‰‡æ ¼å¼: PNG  
é¢œè‰²æ¨¡å¼: RGB  
ç¼–ç : æ ‡å‡†PNG

## åç»­æ­¥éª¤

ç”Ÿæˆçš„å›¾ç‰‡å¯ä»¥ç”¨äº:

1. **æ­¥éª¤å››**: é…åˆå¯¹è¯ç”ŸæˆéŸ³é¢‘
2. **æ­¥éª¤äº”**: åˆæˆæœ€ç»ˆè§†é¢‘
3. **é¢„è§ˆ**: åˆ›å»ºWebé¡µé¢å±•ç¤ºå›¾æ–‡ç»“åˆæ•ˆæœ
4. **ç¼–è¾‘**: ä½¿ç”¨Photoshopç­‰å·¥å…·è¿›ä¸€æ­¥ç¼–è¾‘

## æœ€ä½³å®è·µ

### 1. ä¼˜åŒ–è¾“å…¥JSON

åœ¨è¿è¡Œåˆ†é•œç”Ÿæˆå‰ï¼Œå»ºè®®æ£€æŸ¥å’Œä¼˜åŒ–JSON:

```bash
# æŸ¥çœ‹è§’è‰²æè¿°æ˜¯å¦è¯¦ç»†
jq '.characters' script.json

# æŸ¥çœ‹åœºæ™¯åŠ¨ä½œæè¿°
jq '.script[] | {scene_id, action_description}' script.json
```

### 2. åˆ†æ‰¹å¤„ç†

å¯¹äºå¤§é‡åœºæ™¯ï¼Œå»ºè®®åˆ†æ‰¹å¤„ç†:

```bash
# ç”Ÿæˆå‰5ä¸ªåœºæ™¯
jq '{script: .script[0:5], characters}' full.json > batch1.json
./storyboard -input batch1.json -output batch1

# ç”Ÿæˆåç»­åœºæ™¯
jq '{script: .script[5:10], characters}' full.json > batch2.json
./storyboard -input batch2.json -output batch2
```

### 3. éªŒè¯ç»“æœ

```bash
# æ£€æŸ¥æ‰€æœ‰å›¾ç‰‡
ls -lh storyboard/*.png

# ç»Ÿè®¡ç”Ÿæˆæ•°é‡
ls storyboard/*.png | wc -l
```

## æ•…éšœæ’é™¤

### å›¾ç‰‡æ— æ³•ä¿å­˜

```bash
# æ£€æŸ¥ç›®å½•æƒé™
ls -ld storyboard/

# åˆ›å»ºç›®å½•
mkdir -p storyboard
chmod 755 storyboard
```

### APIé™æµ

å¦‚æœé‡åˆ°é™æµï¼Œæ·»åŠ å»¶è¿Ÿ:

```bash
# ä¿®æ”¹ä»£ç æ·»åŠ sleep
# æˆ–åˆ†å¤šæ¬¡è¿è¡Œ
```

### ç½‘ç»œé—®é¢˜

```bash
# æµ‹è¯•APIè¿é€šæ€§
curl -I https://openai.qiniu.com/v1/models

# æ£€æŸ¥ä»£ç†è®¾ç½®
echo $HTTP_PROXY
```

## å‚è€ƒæ–‡æ¡£

- [ä¸ƒç‰›äº‘æ–‡ç”Ÿå›¾APIæ–‡æ¡£](https://developer.qiniu.com/aitokenapi/13166/text-to-image-api)
- [Gemini 2.5 Flash Image æ¨¡å‹ä»‹ç»](https://developer.qiniu.com/aitokenapi/13166/text-to-image-api)

